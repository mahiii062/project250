<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Services - Nibash</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg: #faf9f7;
      --card: #f5efe6;
      --accent: #8a5a3a;
      --muted: #bfb6ad;
      --soft: #f1e8dd;
      --shadow: rgba(20,20,20,0.06);
    }
    *{box-sizing:border-box;font-family:'Poppins',system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial;}
    body{
      margin:0;
      background:var(--bg);
      color:#333;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
      min-height:100vh;
    }

    /* Header */
    header {
      background: white;
      padding: 1rem 2rem;
      display: flex;
      justify-content: space-between;
      align-items: center;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    }
    .logo { display:flex; align-items:center; gap:10px; font-weight:600; font-size:22px; }
    .logo-img { width:40px;height:40px;border-radius:50%;object-fit:cover; }
    header nav a { margin-left: 1rem; text-decoration: none; color: #333; }
    .logout-btn { background: #b71c1c; color: white; padding: 0.4rem 1rem; border-radius: 6px; }

    /* layout */
    .dashboard { display: flex; min-height: calc(100vh - 60px); }

    /* Sidebar */
    .sidebar {
      width: 220px;
      background: white;
      padding: 1.5rem;
      border-right: 1px solid #eee;
      position: relative;
    }
    .sidebar h3 { margin-bottom: 1rem; font-weight: 600; }
    .sidebar a {
      display: flex; align-items: center; justify-content: space-between;
      padding: 0.6rem 1rem; margin: 0.3rem 0; text-decoration: none; color: #555;
      border-radius: 6px; position: relative;
    }
    .sidebar a:hover { background: #f5efe6; font-weight: 600; }
    .sidebar a::after { content: "üçÇ"; font-size: 1rem; opacity: 0.5; pointer-events: none; }

    /* main content */
    .content { flex: 1; padding: 2rem; }

    /* HERO / SLIDER */
    .hero {
      position: relative;
      overflow: hidden;
      border-radius: 12px;
      min-height: 400px;
      box-shadow: 0 8px 24px var(--shadow);
      margin-bottom: 1.5rem;
      display: flex;
      align-items: center;
      justify-content: flex-start;
      padding: 28px;
      gap: 24px;
      background: linear-gradient(135deg, #2c3e50, #4a2c18);
    }
    .hero-text-overlay {
      position: relative;
      z-index: 3;
      width: min(680px, 63%);
      background: rgba(255,255,255,0.06);
      color: #fff;
      padding: 28px;
      border-radius: 12px;
      backdrop-filter: blur(4px);
      -webkit-backdrop-filter: blur(4px);
      box-shadow: 0 6px 20px rgba(0,0,0,0.25);
    }
    .hero-text-overlay h1 {
      margin:0 0 12px 0; font-size:32px; line-height:1.05; font-weight:700;
      text-shadow: 0 2px 8px rgba(0,0,0,0.55);
    }
    .hero-text-overlay p { margin:0; opacity:0.95; line-height:1.6; font-size:15px; color: #fff; }

    /* Tabs */
    .tabs {
      display: flex;
      gap: 8px;
      margin-bottom: 1.5rem;
      background: white;
      padding: 8px;
      border-radius: 12px;
      box-shadow: 0 2px 8px var(--shadow);
    }
    .tab {
      flex: 1;
      padding: 12px 16px;
      border: none;
      background: transparent;
      border-radius: 8px;
      cursor: pointer;
      font-weight: 600;
      transition: all 0.2s ease;
    }
    .tab.active {
      background: var(--accent);
      color: white;
    }

    /* Controls */
    .controls {
      background: var(--card);
      padding: 16px;
      border-radius: 12px;
      box-shadow: 0 6px 18px var(--shadow);
      margin-bottom: 1.5rem;
      display: flex;
      flex-wrap: wrap;
      gap: 16px;
      align-items: center;
    }
    .search {
      display: flex;
      gap: 8px;
      align-items: center;
      flex: 1;
      min-width: 300px;
    }
    .search input {
      flex: 1;
      padding: 10px 12px;
      border: 1px solid var(--muted);
      border-radius: 8px;
      font-size: 14px;
    }
    .filters {
      display: flex;
      gap: 16px;
      align-items: center;
      flex-wrap: wrap;
    }
    .filters label {
      display: flex;
      flex-direction: column;
      gap: 4px;
      font-size: 14px;
      font-weight: 600;
    }
    .filters select, .filters input {
      padding: 8px 12px;
      border: 1px solid var(--muted);
      border-radius: 6px;
      font-size: 14px;
    }
    .add-btn {
      background: var(--accent);
      color: white;
      border: none;
      padding: 10px 16px;
      border-radius: 8px;
      cursor: pointer;
      font-weight: 600;
      transition: all 0.2s ease;
    }
    .add-btn:hover {
      background: #d38b5f;
      transform: translateY(-2px);
    }

    /* Service Cards */
    .services {
      display: flex;
      flex-direction: column;
      gap: 2rem;
    }
    .sub-section h2 {
      margin: 0 0 1rem 0;
      font-size: 1.5rem;
      color: var(--accent);
      font-weight: 600;
    }
    .service-list {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
      gap: 1rem;
    }
    .service-card {
      background: white;
      padding: 16px;
      border-radius: 12px;
      box-shadow: 0 6px 18px var(--shadow);
      transition: transform 0.2s ease;
    }
    .service-card:hover {
      transform: translateY(-4px);
    }
    .card-top {
      display: flex;
      gap: 12px;
      align-items: flex-start;
      margin-bottom: 12px;
    }
    .card-top img {
      width: 80px;
      height: 80px;
      border-radius: 8px;
      object-fit: cover;
      border: 3px solid white;
      box-shadow: 0 3px 8px rgba(0,0,0,0.1);
    }
    .card-info h3 {
      margin: 0 0 4px 0;
      font-size: 1.1rem;
      font-weight: 600;
    }
    .meta {
      margin: 0 0 6px 0;
      font-size: 0.9rem;
      color: #666;
    }
    .rating {
      display: flex;
      align-items: center;
      gap: 6px;
      font-size: 0.9rem;
      color: #ffa500;
    }
    .rating-num {
      color: #666;
      font-weight: 600;
    }
    .card-actions {
      display: flex;
      gap: 8px;
    }
    .btn {
      padding: 8px 12px;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-size: 0.9rem;
      font-weight: 600;
      transition: all 0.2s ease;
      flex: 1;
    }
    .btn.small {
      padding: 6px 10px;
      font-size: 0.8rem;
    }
    .btn.primary {
      background: var(--accent);
      color: white;
    }
    .btn.ghost {
      background: transparent;
      border: 1px solid var(--muted);
      color: #666;
    }
    .btn.danger {
      background: #dc3545;
      color: white;
    }
    .btn:hover {
      transform: translateY(-2px);
    }

    /* Modals */
    .modal {
      position: fixed;
      inset: 0;
      display: none;
      align-items: center;
      justify-content: center;
      background: rgba(0,0,0,0.5);
      z-index: 9999;
    }
    .modal.active {
      display: flex;
    }
    .modal-card {
      width: 420px;
      max-width: 94%;
      background: white;
      padding: 24px;
      border-radius: 12px;
      box-shadow: 0 10px 40px rgba(0,0,0,0.3);
    }
    .modal-close {
      float: right;
      background: transparent;
      border: none;
      font-size: 20px;
      cursor: pointer;
      color: #666;
    }
    .modal-card h3 {
      margin: 0 0 16px 0;
      font-size: 1.3rem;
      color: var(--accent);
    }
    .modal-card label {
      display: block;
      margin-bottom: 12px;
      font-weight: 600;
    }
    .modal-card input, .modal-card textarea, .modal-card select {
      width: 100%;
      padding: 10px 12px;
      border: 1px solid var(--muted);
      border-radius: 6px;
      font-size: 14px;
      margin-top: 4px;
    }
    .modal-actions {
      display: flex;
      gap: 8px;
      justify-content: flex-end;
      margin-top: 16px;
    }
    .empty {
      text-align: center;
      color: #666;
      font-style: italic;
      padding: 2rem;
    }

    /* Responsive */
    @media (max-width: 1024px) {
      .sidebar { display: none; }
      .content { padding: 1rem; }
      .hero { min-height: 300px; padding: 1.5rem; }
      .controls { flex-direction: column; align-items: stretch; }
      .search { min-width: auto; }
    }
    @media (max-width: 600px) {
      .service-list { grid-template-columns: 1fr; }
      .hero-text-overlay h1 { font-size: 24px; }
      .card-actions { flex-direction: column; }
    }
  </style>
</head>
<body>

  <header>
    <div class="logo"><img src="../images/mainLogo.png" alt="Nibash Logo" class="logo-img">Nibash</div>
    <nav>
      <a href="../users/customer.html">Home</a>
      <a href="../users/vendor.html">Vendor</a>
      <a href="../index.html" class="logout-btn">Log out</a>
    </nav>
  </header>

  <div class="dashboard">
    <!-- sidebar -->
    <aside class="sidebar" aria-label="Account menu">
      <a href="../users/customerDashboard.html"><h3>My Account</h3></a>
      <a href="#" class="active">Profile</a>
      <a href="#">Wishlist</a>
      <a href="#">Orders</a>
      <a href="#">Saved Collections</a>
      <a href="#">Settings</a>
    </aside>

    <!-- main -->
    <main class="content">

      <!-- HERO -->
      <section class="hero" role="banner" aria-label="hero">
        <div class="hero-text-overlay" aria-live="polite">
          <h1>Find Trusted Home Service Professionals</h1>
          <p>
            Electricians, Plumbers & Painters ‚Äî highest rated, near you, and easy to contact. 
            Connect with skilled professionals for all your home service needs.
          </p>
        </div>
      </section>

      <!-- Tabs -->
      <nav class="tabs" role="tablist">
        <button class="tab active" data-tab="electrician">Electricians</button>
        <button class="tab" data-tab="plumber">Plumbers</button>
        <button class="tab" data-tab="painter">Painters</button>
      </nav>

      <!-- Controls -->
      <section class="controls">
        <div class="search">
          <input id="searchInput" type="text" placeholder="Search by name or location..." />
          <button class="btn primary" id="searchBtn">Search</button>
          <button class="btn ghost" id="clearSearchBtn" title="Clear search">‚úï</button>
        </div>

        <div class="filters">
          <label>
            Sort:
            <select id="sortSelect">
              <option value="recommended">Recommended</option>
              <option value="rating-desc">Rating: High ‚Üí Low</option>
              <option value="rating-asc">Rating: Low ‚Üí High</option>
              <option value="name-asc">Name A ‚Üí Z</option>
            </select>
          </label>

          <label>
            "Near you" location:
            <input id="userLocation" type="text" placeholder="e.g., Dhaka" />
          </label>

          <button id="addBtn" class="add-btn">+ Add New</button>
        </div>
      </section>

      <!-- Services Sections -->
      <section id="serviceArea" class="services">
        <div class="sub-section">
          <h2 id="highestTitle">Highest Rated</h2>
          <div id="highestList" class="service-list"></div>
        </div>

        <div class="sub-section">
          <h2 id="nearTitle">Near You</h2>
          <div id="nearList" class="service-list"></div>
        </div>

        <div class="sub-section">
          <h2 id="allTitle">All Professionals</h2>
          <div id="allList" class="service-list"></div>
        </div>
      </section>

    </main>
  </div>

  <!-- Add/Edit Form Modal -->
  <div id="formModal" class="modal" role="dialog" aria-modal="true">
    <div class="modal-card">
      <button class="modal-close" onclick="closeForm()">‚úï</button>
      <h3 id="formTitle">Add Professional</h3>
      <form id="serviceForm">
        <input type="hidden" id="serviceType" value="electrician">
        <input type="hidden" id="editIndex" value="-1">
        <label>
          Full name
          <input id="nameInput" type="text" required />
        </label>

        <label>
          Location
          <input id="locationInput" type="text" required />
        </label>

        <label>
          Rating (1-5)
          <input id="ratingInput" type="number" min="1" max="5" step="0.5" value="5" required />
        </label>

        <label>
          Image URL (optional)
          <input id="imageInput" type="text" placeholder="../images/logo2.png" />
        </label>

        <div class="modal-actions">
          <button type="button" class="btn primary" onclick="submitForm()">Save</button>
          <button type="button" class="btn ghost" onclick="closeForm()">Cancel</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Contact Modal -->
  <div id="contactModal" class="modal" role="dialog" aria-modal="true">
    <div class="modal-card">
      <button class="modal-close" onclick="closeContact()">‚úï</button>
      <h3>Contact <span id="contactName"></span></h3>
      <form id="contactForm" onsubmit="sendContact(event)">
        <label>
          Your name
          <input id="contacterName" type="text" required />
        </label>

        <label>
          Message
          <textarea id="contactMessage" rows="4" placeholder="Describe the problem or request..." required></textarea>
        </label>

        <div class="modal-actions">
          <button type="submit" class="btn primary">Send Message</button>
          <button type="button" class="btn ghost" onclick="closeContact()">Cancel</button>
        </div>

        <p class="contact-note" style="font-size: 0.8rem; color: #666; margin-top: 1rem;">
          Tip: you can wire this to an email/WhatsApp or an API to actually send messages.
        </p>
      </form>
    </div>
  </div>

  <script>
    /* ----------------------------
       Data model and persistence
       ---------------------------- */
    const defaultElectricians = [
      { name: "Rashid Karim", location: "Dhaka", rating: 5, image: "../images/artist.jpg" },
      { name: "Aminul Haque", location: "Chattogram", rating: 4.5, image: "../images/artist2.jpg" }
    ];
    const defaultPlumbers = [
      { name: "Jamal Uddin", location: "Dhaka", rating: 5, image: "../images/artist.jpg" },
      { name: "Kamal Hossain", location: "Sylhet", rating: 4, image: "../images/artist2.jpg" }
    ];
    const defaultPainters = [
      { name: "Sadia Akter", location: "Dhaka", rating: 5, image: "../images/artist1.jpg" },
      { name: "Tariq Islam", location: "Chattogram", rating: 4.5, image: "../images/artist1.jpg" },
      { name: "Farzana Rahman", location: "Sylhet", rating: 4, image: "../images/artist1.jpg" },
      { name: "Rafiq Ahmed", location: "Dhaka", rating: 4.5, image: "../images/artist1.jpg" }
    ];

    function getKey(type) { return type + "s"; }
    
    function loadFromStorage(type) {
      const raw = localStorage.getItem(getKey(type));
      if (!raw) {
        let initial;
        if (type === "electrician") initial = defaultElectricians;
        else if (type === "plumber") initial = defaultPlumbers;
        else if (type === "painter") initial = defaultPainters;
        localStorage.setItem(getKey(type), JSON.stringify(initial));
        return initial.slice();
      }
      try { return JSON.parse(raw); } catch { return []; }
    }

    function saveToStorage(type, arr) { localStorage.setItem(getKey(type), JSON.stringify(arr)); }

    /* ----------------------------
       UI state
       ---------------------------- */
    let activeTab = "electrician";
    const tabs = document.querySelectorAll(".tab");
    const searchInput = document.getElementById("searchInput");
    const sortSelect = document.getElementById("sortSelect");
    const userLocation = document.getElementById("userLocation");

    // initial load
    function init() {
      document.querySelectorAll(".tab").forEach(btn => {
        btn.addEventListener("click", () => switchTab(btn.dataset.tab));
      });

      document.getElementById("addBtn").addEventListener("click", () => openForm("add"));

      document.getElementById("searchBtn").addEventListener("click", render);
      document.getElementById("clearSearchBtn").addEventListener("click", () => { searchInput.value = ""; render(); });
      document.getElementById("sortSelect").addEventListener("change", render);
      document.getElementById("userLocation").addEventListener("input", render);

      // pre-create storage if missing
      loadFromStorage("electrician");
      loadFromStorage("plumber");
      loadFromStorage("painter");

      render();
    }

    function switchTab(tab) {
      activeTab = tab;
      tabs.forEach(t => t.classList.toggle("active", t.dataset.tab === tab));
      document.getElementById("formTitle").textContent = `Add ${capitalize(tab)}`;
      document.getElementById("serviceType").value = tab;
      render();
    }

    /* ----------------------------
       Rendering helpers
       ---------------------------- */
    function render() {
      const type = activeTab;
      const services = loadFromStorage(type);
      const query = searchInput.value.trim().toLowerCase();
      const loc = userLocation.value.trim().toLowerCase();

      // Filter by search
      let filtered = services.filter(s => {
        if (!query) return true;
        return s.name.toLowerCase().includes(query) || s.location.toLowerCase().includes(query);
      });

      // Highest rated: rating >= 4.5
      const highest = filtered.filter(s => parseFloat(s.rating) >= 4.5);

      // Near you: if user provided location, match; else default empty
      const near = loc ? filtered.filter(s => s.location.toLowerCase() === loc) : [];

      // All list sorted by selected sort
      const sort = sortSelect.value;
      let all = filtered.slice();
      if (sort === "rating-desc") all.sort((a,b)=>b.rating - a.rating);
      else if (sort === "rating-asc") all.sort((a,b)=>a.rating - b.rating);
      else if (sort === "name-asc") all.sort((a,b)=> a.name.localeCompare(b.name));
      else if (sort === "recommended") all.sort((a,b)=> b.rating - a.rating || a.name.localeCompare(b.name));

      document.getElementById("highestList").innerHTML = renderCards(highest, type);
      document.getElementById("nearList").innerHTML = renderCards(near, type);
      document.getElementById("allList").innerHTML = renderCards(all, type, true);
      
      document.getElementById("highestTitle").textContent = `Highest Rated ${capitalize(type)}s`;
      document.getElementById("nearTitle").textContent = `${capitalize(type)}s Near "${userLocation.value || '...' }"`;
      document.getElementById("allTitle").textContent = `All ${capitalize(type)}s`;
    }

    function renderCards(list, type, includeIndex = false) {
      if (!list || list.length === 0) return `<p class="empty">No results.</p>`;
      const storage = loadFromStorage(type);
      return list.map(item => {
        const index = storage.findIndex(s => s.name === item.name && s.location === item.location && String(s.rating) === String(item.rating));
        return cardHtml(item, type, index);
      }).join("");
    }

    function cardHtml(item, type, index) {
      const img = item.image || "../images/logo2.png";
      const ratingStars = renderStars(item.rating);
      return `
        <div class="service-card">
          <div class="card-top">
            <img src="${img}" alt="${escapeHtml(item.name)}" />
            <div class="card-info">
              <h3>${escapeHtml(item.name)}</h3>
              <p class="meta">üìç ${escapeHtml(item.location)}</p>
              <p class="rating"> ${ratingStars} <span class="rating-num">${item.rating}</span></p>
            </div>
          </div>

          <div class="card-actions">
            <button class="btn primary small" onclick="openContact('${escapeJs(item.name)}')">Message</button>
            <button class="btn ghost small" onclick="openForm('edit', '${type}', ${index})">Edit</button>
            <button class="btn danger small" onclick="deleteItem('${type}', ${index})">Delete</button>
          </div>
        </div>
      `;
    }

    function renderStars(rating) {
      const full = Math.floor(rating);
      const half = (rating - full) >= 0.5 ? 1 : 0;
      const empty = 5 - full - half;
      return "‚òÖ".repeat(full) + (half ? "‚òÜ" : "") + "‚ú©".repeat(empty);
    }

    /* ----------------------------
       CRUD operations
       ---------------------------- */
    function openForm(mode='add', type = null, index = -1) {
      const modal = document.getElementById("formModal");
      modal.classList.add("active");
      document.getElementById("serviceType").value = type || activeTab;
      document.getElementById("editIndex").value = index;

      if (mode === "add") {
        document.getElementById("formTitle").textContent = `Add ${capitalize(type || activeTab)}`;
        document.getElementById("serviceForm").reset();
        document.getElementById("ratingInput").value = 5;
      } else {
        document.getElementById("formTitle").textContent = `Edit ${capitalize(type)}`;
        const arr = loadFromStorage(type);
        const item = arr[index];
        if (item) {
          document.getElementById("nameInput").value = item.name;
          document.getElementById("locationInput").value = item.location;
          document.getElementById("ratingInput").value = item.rating;
          document.getElementById("imageInput").value = item.image || "";
        }
      }
    }

    function closeForm() { document.getElementById("formModal").classList.remove("active"); }

    function submitForm() {
      const type = document.getElementById("serviceType").value;
      const index = parseInt(document.getElementById("editIndex").value, 10);
      const name = document.getElementById("nameInput").value.trim();
      const location = document.getElementById("locationInput").value.trim();
      const rating = parseFloat(document.getElementById("ratingInput").value);
      const image = document.getElementById("imageInput").value.trim() || "../images/logo2.png";

      if (!name || !location || !rating) {
        alert("Please fill in all required fields.");
        return;
      }

      const arr = loadFromStorage(type);
      if (index >= 0) {
        arr[index] = { name, location, rating, image };
      } else {
        arr.push({ name, location, rating, image });
      }
      saveToStorage(type, arr);
      closeForm();
      render();
    }

    function deleteItem(type, index) {
      if (!confirm("Delete this profile?")) return;
      const arr = loadFromStorage(type);
      arr.splice(index, 1);
      saveToStorage(type, arr);
      render();
    }

    /* ----------------------------
       Contact modal
       ---------------------------- */
    function openContact(name) {
      document.getElementById("contactName").textContent = name;
      document.getElementById("contacterName").value = "";
      document.getElementById("contactMessage").value = "";
      document.getElementById("contactModal").classList.add("active");
    }

    function closeContact() { document.getElementById("contactModal").classList.remove("active"); }

    function sendContact(e) {
      e.preventDefault();
      const to = document.getElementById("contactName").textContent;
      const sender = document.getElementById("contacterName").value.trim();
      const msg = document.getElementById("contactMessage").value.trim();
      if (!sender || !msg) { alert("Please fill name and message."); return; }
      alert(`Message sent to ${to}:\n\nFrom: ${sender}\n\n${msg}`);
      closeContact();
    }

    /* ----------------------------
       Utilities
       ---------------------------- */
    function capitalize(s) { return s.charAt(0).toUpperCase() + s.slice(1); }
    function escapeHtml(s) {
      if (!s) return "";
      return s.replace(/[&<>"']/g, c => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'})[c]);
    }
    function escapeJs(s) { return s.replace(/'/g, "\\'"); }

    // Initialize
    document.getElementById("addBtn").addEventListener("click", () => {
      document.getElementById("serviceType").value = activeTab;
      document.getElementById("editIndex").value = -1;
      openForm("add", activeTab, -1);
    });

    init();
  </script>
</body>
</html>